{% extends "default.html" %}

{% block content %}

    <div class="container">
        <div class="row">
            <div class="col s12">
            {% if selected_PhD_form %}
            {{ selected_PhD_form.media }}
            <h3>Suggest a change</h3>
            <p>Your changes will appear after a moderator approves your submission. </p>
            <form id="suggested-edits-form">
                {{ selected_PhD_form.non_field_errors }}
                <div class="row section">
                    <div class="col s12 m6 ">
                        {{ selected_PhD_form.firstName.errors }}
                        {{ selected_PhD_form.firstName.label_tag }}
                        {{ selected_PhD_form.firstName }}
                    </div>
                    <div class="col s12 m6 ">
                        {{ selected_PhD_form.lastName.errors }}
                        {{ selected_PhD_form.lastName.label_tag }}
                        {{ selected_PhD_form.lastName }}
                    </div>
                </div>

                <div class="row section">
                    <div class="col s12 m6 ">
                        {{ selected_PhD_form.year.errors }}
                        {{ selected_PhD_form.year.label_tag }}
                        {{ selected_PhD_form.year }}
                    </div>
                    <div class="col s12 m6 ">
                        {{ selected_PhD_form.school.errors }}
                        {{ selected_PhD_form.school.label_tag }}
                        {{ selected_PhD_form.school }}
                    </div>
                </div>
                <div class="row section">
                    <div class="col s10 m6 ">
                        {{ selected_PhD_form.specialization.errors }}
                        {{ selected_PhD_form.specialization.label_tag }}
                        {{ selected_PhD_form.specialization }}
                    </div>
                    <div class="col s12 m6 ">
                        {{ selected_PhD_form.advisor.errors }}
                        {{ selected_PhD_form.advisor.label_tag }}
                        {{ selected_PhD_form.advisor }}
                    </div>
                    <input id="selected_person_id" name="selected_person_id" value="{{ selectedID }}" style="display:none;">
                </div>

            </form>
            <div class="row section">
                <form method="post" action="/suggested_change/">
                    {% csrf_token %}
                    {% comment %}
                    This is the form that actually gets submitted, of form class PhDUpdateForm
                    {% endcomment %}
                    <h4>Just a couple more things....</h4>
                    {{ form.as_p }}
                <button id="suggest_change_submit" type="submit" class="waves-effect waves-light btn-large center-align btn-100-percent"><i class="material-icons left">input</i>Submit</button>
                </form>
            </div>



            {% else %}
                <h3>Whoops!</h3>
                <p>You got here by mistake...try another page</p>
            {% endif %}
            </div>
        </div>
    </div>

{% endblock %}

{% block javascript_doc_ready %}
<script>
$(document).ready(function() {
    $("#id_suggested_update_fixture").hide();
    $("label[for='id_suggested_update_fixture']").hide();
    $('select').material_select();
    //$("#id_specialization").addClass("browser-default");
    $("#suggest_change_submit").on("click", function(){
        var ob = Object();
        ob.id = $("#selected_person_id").val();
        ob.firstName = $("#id_firstName").val();
        ob.lastName = $("#id_lastName").val();
        ob.year = $("#id_year").val();
        ob.school = $("#id_school").val();
        ob.specialization = ($("#id_specialization").val());
        var advisors_literal = $("#id_advisor").val().split("|");
        var advisors = []
        for(var index in advisors_literal){
            if(advisors_literal[index] === "") {
                //pass
            } else{
                advisors.push(advisors_literal[index]);
            }
        }
        ob.advisor = advisors;
        $("#id_suggested_update_fixture").val(JSON.stringify(ob))
    });
  });

</script>

{% endblock %}